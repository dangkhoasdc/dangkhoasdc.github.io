<!DOCTYPE html>
<html lang='en'>

<head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='In this tutorial, I will demonstrate how to configurate the renowned computer vision libary, OpenCV, with the current Android Studio version (3.0.1). Let get started. The compiled version of OpenCV which supports Android is available at OpenCV Homepage. Download and extract it. Please note that to test the application properly on the mobile devices, the OpenCV Manager has to be installed.
In another tutorial, I will talk about how to compile our own OpenCV library and put it to Android Studio since the pre-compiled library misses some interesting and important components, e.'>
<meta name='theme-color' content='#ffcd00'>

<meta property='og:title' content='Setup OpenCV and Android Studio with NDK support • Dang-Khoa'>
<meta property='og:description' content='In this tutorial, I will demonstrate how to configurate the renowned computer vision libary, OpenCV, with the current Android Studio version (3.0.1). Let get started. The compiled version of OpenCV which supports Android is available at OpenCV Homepage. Download and extract it. Please note that to test the application properly on the mobile devices, the OpenCV Manager has to be installed.
In another tutorial, I will talk about how to compile our own OpenCV library and put it to Android Studio since the pre-compiled library misses some interesting and important components, e.'>
<meta property='og:url' content='http://dangkhoasdc.github.io/docs/opencv_android_studio_ndk/'>
<meta property='og:site_name' content='Dang-Khoa&#39;s blog '>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/ff98eba7ca4592a175b13bd623f28f0c?s=256'><meta property='article:author' content='https://facebook.com/dangkhoasdc'><meta property='article:section' content='Docs'><meta property='article:tag' content='android'><meta property='article:tag' content='opencv'><meta property='article:tag' content='programming'><meta property='article:published_time' content='2018-02-25T00:00:00Z'/><meta property='article:modified_time' content='2018-02-25T00:00:00Z'/><meta name='twitter:card' content='summary'><meta name='twitter:creator' content='@dksdc'>

<meta name="generator" content="Hugo 0.53" />

  <title>Setup OpenCV and Android Studio with NDK support • Dang-Khoa</title>
  <link rel='canonical' href='http://dangkhoasdc.github.io/docs/opencv_android_studio_ndk/'>
  
  <link rel='alternate' hreflang='en' href='http://dangkhoasdc.github.io/docs/opencv_android_studio_ndk/'><link rel='alternate' hreflang='x-default' href='http://dangkhoasdc.github.io/docs/opencv_android_studio_ndk/'><link rel='alternate' hreflang='vi' href='http://dangkhoasdc.github.io/vi/docs/opencv_android_studio_ndk/'>
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.809149b6.css'><style>
:root{--color-accent:#ffcd00;}
</style>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2381283-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

</head>


<body class='page type-docs'>

  <div class='site'>

    <a class='screen-reader-text' href='#content'>Skip to Content</a>

    <div class='main'>

      <nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    
    <ul><li class='item'>
        <a href='/docs/' class="">
          <span>Docs</span>
        </a>
      </li><li class='item'>
        <a href='#posts' class="">
          <span>Posts</span>
        </a>
      </li><li class='item'>
        <a href='#about' class="">
          <span>Home</span>
        </a>
      </li><li class='item'>
        <a href='#projects' class="">
          <span>Projects</span>
        </a>
      </li><li class='item'>
        <a href='#publications_selected' class="">
          <span>Publications</span>
        </a>
      </li><li class='item'>
        <a href='/about/' class="">
          <span>About</span>
        </a>
      </li><li class='item'>
        <a href='/tags/notes/' class="">
          <span>Notes</span>
        </a>
      </li></ul>
  </div>
</nav>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Dang-Khoa&#39;s blog </p><p class='desc site-desc'></p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='en' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Setup OpenCV and Android Studio with NDK support</h1>
      

    </div>
    
<div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2018-02-25T00:00:00Z'>2018, Feb 25</time>
</span>

  <span class='byline'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1"/>
  <path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z"/>
  
</svg>
<span class='screen-reader-text'> by </span><a href='/authors/khoa'>Dang-Khoa</a></span>
  

  
  
</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  

<p>In this tutorial, I will demonstrate how to configurate the renowned computer
vision libary, OpenCV, with the current Android Studio version (3.0.1). Let get started.
The compiled version of OpenCV which supports Android is available at <a href="https://opencv.org/releases.html" target="_blank">OpenCV Homepage</a>. Download
and extract it. Please note that to test the application properly on the mobile
devices, the <a href="https://play.google.com/store/apps/details?id=org.opencv.engine&amp;hl=en" target="_blank">OpenCV Manager</a> has to be installed.</p>

<p>In another tutorial, I will talk about how to compile our own OpenCV library
and put it to Android Studio since the pre-compiled library misses some
interesting and important components, e.g, the SIFT features and other licensed
algorithms.</p>

<h2 id="creating-a-new-android-project-with-ndk-support">Creating a new Android project with NDK support</h2>

<p>From the menu, select <code>File-&gt;New-&gt;New Project</code> and select <code>Include C++ support</code>
in the Create New Project dialog.</p>

<figure>
    <img src="https://i.imgur.com/vgMNEYg.png"/> <figcaption>
            <h4>Step 1</h4>
        </figcaption>
</figure>


<p>The next two steps are similar to the setup for normal applications, so I skip
it. Later, the IDE asks the C++ settings for the project, I prefer C++14 over
C++11 and also add two options, namely Exception Support and Runtime Type
Information Support, for the project.</p>

<ol>
<li><p>From the Project Structure windows (<code>File -&gt; Project Structure</code>), we add the
OpenCV module by clicking on the plus sign, selecting the <code>Import Eclipse ADT Project</code>
and pointing to the <code>/path/to/OpenCV4Android/sdk/java</code> directory.</p></li>

<li><p>Select <code>Modules -&gt; app</code>.  In the <code>Dependencies</code> tab, add the OpenCV module
by selecting the plus sign.</p>

<ol>
<li><code>Module Dependency</code>.</li>
<li>Select <code>:openCVLibrary340</code>.</li>
</ol></li>
</ol>

<figure>
    <img src="https://i.imgur.com/CSHlsF7.png"/> <figcaption>
            <h4>Add openCVLibrary340</h4>
        </figcaption>
</figure>


<h2 id="configurate-cmake-and-ndk">Configurate CMAKE and NDK</h2>

<p>In order to get CMAKE properly detect OpenCV, we add the following configuration
to CMAKELists.txt:</p>

<ol>
<li>Add a new library:</li>
</ol>

<pre><code>include_directories(/path/to/OpenCV4Android/sdk/native/jni/include)
add_library( lib_opencv SHARED IMPORTED )
set_target_properties(lib_opencv PROPERTIES IMPORTED_LOCATION /path/to/OpenCV4Android/sdk/native/libs/${ANDROID_ABI}/libopencv_java3.so)
</code></pre>

<ol>
<li>Put <code>lib_opencv</code> to the arguments of <code>target_link_libraries</code> (the last command
in <code>CMakeLists.txt</code>).</li>
</ol>

<p>Beware that the path in CMAKE use <code>/</code> in both Windows and Linux.</p>

<h2 id="configurate-gradle">Configurate Gradle</h2>

<ol>
<li><p>Put <code>abiFilters 'x86', 'x86_64', 'armeabi', 'armeabi-v7a', 'arm64-v8a', 'mips', 'mips64'</code>
in the <code>cmake</code> setting.</p></li>

<li><p>Put the following text inside <code>android</code>:</p></li>
</ol>

<pre><code>sourceSets {
    main {
        jni.srcDirs = ['src/main/cpp']
        jniLibs.srcDirs = ['\path\to\OpenCV-android-sdk\\sdk\\native\\libs']
    }

}
</code></pre>

<p>Build the project again and we are done. In the the couple tutorials I will
demonstate several techniques to manipulate the libary on Android:</p>

<ul>
<li>Transfer OpenCV MAT from Android to NDK code.</li>
<li>Organize the project and source code.
-</li>
</ul>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'>
  <div class='tags'>
  <span class='taxonomy-icon'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
</span>
  <span class='screen-reader-text'>Tags: </span><a class='tag' href='/tags/android'>android</a>, <a class='tag' href='/tags/opencv'>opencv</a>, <a class='tag' href='/tags/programming'>programming</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/docs/programming_pearls/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Programming Pearls</a>
    </div><div class='next-entry sep-before'>
      <a href='/docs/opencv_android_practices/'>
        <span class='screen-reader-text'>Next post: </span>OpenCV on Android: practices and tips<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>




      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><div class='copyright'>
  <p>&amp;copy; 2017 Dang-Khoa</p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__public_path__='http:\/\/dangkhoasdc.github.io\/assets\/js\/'</script>

<script src='http://dangkhoasdc.github.io/assets/js/main.68cb493a.js'></script><script type='text/x-mathjax-config'>
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"processEscapes":true}})
</script>

<script type='text/javascript' async src='//unpkg.com/mathjax/MathJax.js?config=TeX-MML-AM_CHTML'></script>





</body>

</html>






















