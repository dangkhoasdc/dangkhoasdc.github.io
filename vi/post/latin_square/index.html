<!DOCTYPE html>
<html lang="en-us">
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="theme" content="hugo-academic">
  <meta name="generator" content="Hugo 0.40.3" />
  <meta name="author" content="Dang-Khoa">
  <meta name="description" content="Research Assistant">

  
  
  
    
  
  
    
    
    <link rel="stylesheet" href="/css/highlight.min.css">
    
  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha512-6MXa8B6uaO18Hid6blRMetEIoPqHf7Ux1tnyIQdpt9qI5OACx7C+O3IVTr98vwGnlcg0LOLa02i9Y1HpVhlfiw==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.1/css/academicons.min.css" integrity="sha512-NThgw3XKQ1absAahW6to7Ey42uycrVvfNfyjqcFNgCmOCQ5AR4AO0SiXrN+8ZtYeappp56lk1WtvjVmEa+VR6A==" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha512-SfTiTlX6kk+qitfevl/7LibUOeJWlt9rbyDn92a1DqWOw9vWG2MFoays0sgObmWazO5BQPiFucnnEAjpAB+/Sw==" crossorigin="anonymous">
  
  
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono">
  <link rel="stylesheet" href="/css/hugo-academic.css">
  
  <link rel="stylesheet" href="/css/custom-theme.css">
  

  
    <script>
      window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
      ga('create', 'UA-2381283-3', 'auto');
      ga('require', 'eventTracker');
      ga('require', 'outboundLinkTracker');
      ga('require', 'urlChangeTracker');
      ga('send', 'pageview');
    </script>
    <script async src="//www.google-analytics.com/analytics.js"></script>
    
    <script async src="https://cdnjs.cloudflare.com/ajax/libs/autotrack/2.4.1/autotrack.js" integrity="sha512-HUmooslVKj4m6OBu0OgzjXXr+QuFYy/k7eLI5jdeEy/F4RSgMn6XRWRGkFi5IFaFgy7uFTkegp3Z0XnJf3Jq+g==" crossorigin="anonymous"></script>
    
  

  <link rel="alternate" href="" type="application/rss+xml" title="Dang-Khoa&#39;s blog ">
  <link rel="feed" href="" type="application/rss+xml" title="Dang-Khoa&#39;s blog ">

  <link rel="icon" type="image/png" href="/img/icon.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/apple-touch-icon.png">

  <link rel="canonical" href="http://dangkhoasdc.github.io/vi/post/latin_square/">

  

  <title>Khối Latin và câu chuyện toán học và lịch sử máy tính | Dang-Khoa&#39;s blog </title>

</head>
<body id="top" data-spy="scroll" data-target="#navbar-main" data-offset="71">

<nav class="navbar navbar-default navbar-fixed-top" id="navbar-main">
  <div class="container">

    
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
              data-target=".navbar-collapse" aria-expanded="false">
        <span class="sr-only">Chuyển Điều Hướng</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/vi/">Dang-Khoa&#39;s blog </a>
    </div>

    
    <div class="collapse navbar-collapse">

      
      <ul class="nav navbar-nav navbar-right">
        

        

        <li class="nav-item">
          <a href="/vi/#posts">
            
            <span>Posts</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/vi/#about">
            
            <span>Home</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/vi/#projects">
            
            <span>Projects</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/vi/#publications_selected">
            
            <span>Publications</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/vi/about/">
            
            <span>About</span>
          </a>
        </li>

        
        

        

        <li class="nav-item">
          <a href="/vi/tags/notes/">
            
            <span>Notes</span>
          </a>
        </li>

        
        

        
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true">
            <i class="fa fa-globe" aria-hidden="true"></i>
            <span>Tiếng Việt</span>
          </a>
          <ul class="dropdown-menu">
            
            <li class="nav-item">
              <a href="/post/latin_square/">
                <span>English</span>
              </a>
            </li>
            
          </ul>
        </li>
        
      </ul>

    </div>
  </div>
</nav>


<article class="article" itemscope itemtype="http://schema.org/Article">

  


  <div class="article-container">
    <h1 itemprop="name">Khối Latin và câu chuyện toán học và lịch sử máy tính</h1>
    

<div class="article-metadata">

  <span class="article-date">
    
    <time datetime="2018-02-01 00:00:00 &#43;0000 UTC" itemprop="datePublished">
      2018-02-01
    </time>
  </span>

  

  
  
  
  <span class="article-tags">
    <i class="fa fa-tags"></i>
    
    <a href="/vi/tags/taocp">taocp</a
    >
    
  </span>
  
  

  
  
<div class="share-box" aria-hidden="true">
  <ul class="share">
    <li>
      <a class="facebook"
         href="https://www.facebook.com/sharer.php?u=http%3a%2f%2fdangkhoasdc.github.io%2fvi%2fpost%2flatin_square%2f"
         target="_blank">
        <i class="fa fa-facebook"></i>
      </a>
    </li>
    <li>
      <a class="twitter"
         href="https://twitter.com/intent/tweet?text=Kh%e1%bb%91i%20Latin%20v%c3%a0%20c%c3%a2u%20chuy%e1%bb%87n%20to%c3%a1n%20h%e1%bb%8dc%20v%c3%a0%20l%e1%bb%8bch%20s%e1%bb%ad%20m%c3%a1y%20t%c3%adnh&amp;url=http%3a%2f%2fdangkhoasdc.github.io%2fvi%2fpost%2flatin_square%2f"
         target="_blank">
        <i class="fa fa-twitter"></i>
      </a>
    </li>
    <li>
      <a class="linkedin"
         href="https://www.linkedin.com/shareArticle?mini=true&amp;url=http%3a%2f%2fdangkhoasdc.github.io%2fvi%2fpost%2flatin_square%2f&amp;title=Kh%e1%bb%91i%20Latin%20v%c3%a0%20c%c3%a2u%20chuy%e1%bb%87n%20to%c3%a1n%20h%e1%bb%8dc%20v%c3%a0%20l%e1%bb%8bch%20s%e1%bb%ad%20m%c3%a1y%20t%c3%adnh"
         target="_blank">
        <i class="fa fa-linkedin"></i>
      </a>
    </li>
    
    
    
    
    
    
    
    <li>
      <a class="email"
         href="mailto:?subject=Kh%e1%bb%91i%20Latin%20v%c3%a0%20c%c3%a2u%20chuy%e1%bb%87n%20to%c3%a1n%20h%e1%bb%8dc%20v%c3%a0%20l%e1%bb%8bch%20s%e1%bb%ad%20m%c3%a1y%20t%c3%adnh&amp;body=http%3a%2f%2fdangkhoasdc.github.io%2fvi%2fpost%2flatin_square%2f">
        <i class="fa fa-envelope"></i>
      </a>
    </li>
  </ul>
</div>


  

</div>

    <div class="article-style" itemprop="articleBody">
      

<p>Trong dự án dài hơi về TAoCP, những phần đầu của Vol 4A.</p>

<h1 id="định-nghĩa">Định nghĩa</h1>

<p>Cho một ma trận vuông có kích thước M và các phần tử thuộc $\{0, 1, \cdots, M-1
\}$, ta xây dựng ma trận sao cho mỗi phần tử $i$ trong tập $\{0, 1, \cdots,
M-1\}$ chỉ xuất hiện đúng 1 lần trong mỗi cột và mỗi dòng.</p>

<h3 id="ví-dụ">Ví dụ</h3>

<p>Cho 16 quân bài bao gồm tổ hợp của các quân J, K, Q, A và 4 loại $\heartsuit,
\diamondsuit, \clubsuit, \spadesuit$, ta sắp xếp sao cho mỗi dòng/cột có đủ 4
chất và 4 quân (Jacques Ozaman, mathematiques et physiques, Paris 1725).</p>


<figure>
    
        <img src="https://i.imgur.com/opJooRI.png" />
    
    
    <figcaption>
        <h4>Cách sắp xếp quân bài. Source: TAoCP, Vol 4A.</h4>
        
    </figcaption>
    
</figure>


<h1 id="ứng-dụng">Ứng dụng</h1>

<p>Thực ra trong toán học đôi khi ta không cần một ứng dụng thực tế của một vấn
đề để có động lực nghiên cứu hay tìm hiểu. Tuy nhiên, mình lại là một thanh
niên học khoa học máy tính với thiên hướng &ldquo;engineer&rdquo; hơn là các nhà toán học
cao siêu, nên mình đòi hỏi cái mình học có tính ứng dụng ít nhiều. Về khối
vuông Latin này có kha khá ứng dụng:</p>

<ul>
<li>Sudoku là một dạng của khối vuông Latin, và trò chơi này trở thành một trong
những trò chơi giải đố nổi tiếng nhất thế giới.</li>
<li>Trong cài đặt thí nghiệm.</li>
<li>Mã sửa lỗi.</li>
<li>Mã hóa.</li>
</ul>

<h1 id="câu-chuyện-lịch-sử">Câu chuyện lịch sử</h1>

<p>Năm 1779, một câu đố tương tự như trong phần ví dụ đã thu hút nhà toán học
vĩ đại: Leonhard Euler</p>

<blockquote>
<p>Thirty-six officers of six different ranks, taken from six different
regiments, want to march in a $6 \times 6$ formation so that each row and
each column will contain one officer of each rank and one of each regiment.
How can they do it?</p>
</blockquote>

<p>Dù đã gần như mù nhưng Euler vẫn quyết tâm giải bài toán này và tổng quát hóa
cho các trường hợp $M = 1, 2, \cdots$. Tuy nhiên, với $M\mod 4 = 2$ khiến ông
không giải được, Sau đó ông đã đưa ra một conjenture rằng không thể giải
câu đố này với trường hợp tổng quát $M \mod 4 = 2$.</p>

<p>Tuy nhiên phần định nghĩa về khối Latin hơi khác 1 chút so với phần ví
dụ. Nếu ta đặt $\heartsuit = 1, \diamondsuit = 2, \clubsuit = 3, \spadesuit = 4$,
và tách chất và quân bài ra 2 ma trận, ta được 2 ma trận Latin.</p>

<p>$$
\begin{bmatrix}
J&amp; A&amp; K&amp; Q\newline
Q&amp; K&amp; A&amp; J\newline
A&amp; J&amp; Q&amp; K\newline
K&amp; Q&amp; J&amp; A
\end{bmatrix}
$$</p>

<p>và</p>

<p>$$
\begin{bmatrix}
2&amp; 1&amp; 4&amp; 3\newline
4&amp; 3&amp; 2&amp; 1\newline
3&amp; 4&amp; 1&amp; 2\newline
1&amp; 2&amp; 3&amp; 4
\end{bmatrix}
$$</p>

<p>Figure 1 trở thành</p>

<p>$$
\begin{bmatrix}
J2&amp; A1&amp; K4&amp; Q3\newline
Q4&amp; K3&amp; A2&amp; J1\newline
A3&amp; J4&amp; Q1&amp; K2\newline
K1&amp; Q2&amp; J3&amp; A4
\end{bmatrix}
$$</p>

<p>Hai ma trận được gọi là orthogonal khi chập các phần tử lại với nhau, mỗi phần
tử trong ma trận mới là duy nhất.
Bài toán lúc đó Euler phải giải là: cho 1 ma trận Latin, làm sao để tìm được
một ma trận Latin khác orthogonal với nó.
Ma trận sau khi được chập lại gọi là Graeco-Latin.
Để chứng minh nhận định của Euler đúng hay sai, các nhà toán học đã mất gần 180
năm với sự giúp đỡ của máy tính.</p>

<p>Năm 1957, Paige và Tompkins đã thử lập trình trên máy SWAC để tìm ví dụ phản
chứng khi $M=10$ nhưng sau gần 5 giờ chạy liên tục không ra kết quả, họ đã
tắt chương trình.</p>

<p>Năm 1960, Parker và đồng sự đã chứng minh rằng có thể tìm được 1 ma trận orthogonal
với $M \geq 6$ và phản chứng nhận định của Euler. Đồng thời, ông cũng viết
1 chương trình trên máy UNIVAC 1206 để sinh ra ma trận đó. Chương trình chưa
đến 1 giờ để có thể tìm ra lời giải với cùng input năm 1957:</p>

<pre><code>0 1 2 3 4 5 6 7 8 9
1 8 3 2 5 4 7 6 9 0
2 9 5 6 3 0 8 4 7 1
3 7 0 9 8 6 1 5 2 4
4 6 7 5 2 9 0 8 1 3
5 0 9 4 7 8 3 1 6 2
6 5 4 7 1 3 2 9 0 8
7 4 1 8 0 2 9 3 5 6
8 3 6 0 9 1 5 2 4 7
9 2 8 1 6 7 4 0 3 5
</code></pre>

<p>Một solution trong sách:</p>

<pre><code>0 2 8 5 9 4 7 3 6 1
1 7 4 9 3 6 5 0 2 8
2 5 6 4 8 7 0 1 9 3
3 6 9 0 4 5 8 2 1 7
4 8 1 7 5 3 6 9 0 2
5 1 7 8 0 2 9 4 3 6
6 9 0 2 7 1 3 8 4 5
7 3 5 1 2 0 4 6 8 9
8 0 2 3 6 9 1 7 5 4
9 4 3 6 1 8 2 5 7 0

</code></pre>

<h1 id="transvervals">Transvervals</h1>

<p>Parker sử dụng lại khái niệm transversal mà trước đây Euler từng định nghĩa,
transversal là cách để chọn ra chuỗi $M$ phần tử sao cho chỉ có 1 phần tử duy
nhất ở mỗi dòng, mỗi cột và duy nhất trong transversal.</p>

<p>Ví dụ: 0859734216, tức ta chọn 0 ở cột 1, 8 ở cột 2, 5 ở cột 3, &hellip; 6 ở cột 10.
Giả sử ta có $k$ là giá trị đầu tiên của transversal, dựa vào giá trị từng phần
tử phía sau, ta thay bằng $k$. Chọn ra $M$ transversal của $k = 0, 1, \cdots, M-1$
ta sẽ tạo thành 1 orthogonal matrix.</p>

<p>Thuật toán đếm số transversal của một ma trận vuông N.</p>

<pre><code class="language-cpp">typedef vector&lt;vector&lt;int&gt;&gt; mat;
class transversal {
private:
    int n;
    vector&lt;bool&gt; row;
    vector&lt;bool&gt; nums;
    mat input;
    int cnt;
public:
    transversal(const mat&amp; in_): n(in_.size()), input(in_),
    row(n, false), nums(n, false), cnt(0) {
        assert(in_.size() == in_[0].size());
    }

    void print() { // debugging
        for (auto&amp; rows: input) {
            for (auto&amp; e: rows) cout &lt;&lt; e &lt;&lt; &quot; &quot;;
            cout &lt;&lt; endl;
        }
    }

    int compute(int idx) {
        cnt = 0;
        fill(row.begin(), row.end(), false);
        fill(nums.begin(), nums.end(), false);
        nums[input[idx][0]] = true;
        row[idx] = true;
        comp(1);
        return cnt;
    }


private:
    void comp(int idx) { //idx = index of column
        if (idx == n) {
            cnt++;
            return;
        }

        for (int i = 0; i &lt; n; ++i) {
            if (!row[i] &amp;&amp; !nums[input[i][idx]] ) {
                row[i] = true;
                nums[input[i][idx]] = true;
                comp(idx+1);
                row[i] = false;
                nums[input[i][idx]] = false;
            }
        }

    }

};
</code></pre>

<p>Lấy input từ cuốn TAoCP ra được kết quả:</p>

<pre><code>79 96 76 87 70 84 83 75 95 63
</code></pre>

<p>Bem, đúng với kết quả trong sách. Chỉnh sửa một chút ta có thể có được toàn
bộ các transversal cần tìm. Sau đó với mỗi transversal của $k$, ta chọn ra bộ nào
không có phần tử trùng (trong index của orthogonal matrix), ta sẽ tìm được
ma trận. Chi tiết về phần này sẽ được đề cập trong bài viết nói về
Dancing Links.</p>

<h1 id="tài-liệu-tham-khảo">Tài liệu tham khảo</h1>

<ol>
<li>Knuth, Donald E. The Art of Computer Programming, Volume 4A: Combinatorial Algorithms, Part 1. Pearson Education India, 2011.</li>
<li><a href="https://en.wikipedia.org/wiki/Latin_square" target="_blank">https://en.wikipedia.org/wiki/Latin_square</a></li>
<li><a href="http://elscorcho.50webs.com/latinsquares.pdf" target="_blank">http://elscorcho.50webs.com/latinsquares.pdf</a></li>
</ol>

    </div>
  </div>

</article>

<div class="container">
  <nav>
  <ul class="pager">
    
    <li class="previous"><a href="http://dangkhoasdc.github.io/vi/post/who_am_i/"><span
      aria-hidden="true">&larr;</span> Tôi là ai</a></li>
    

    
    <li class="next"><a href="http://dangkhoasdc.github.io/vi/post/programming_pearls/">Programming Pearls <span
      aria-hidden="true">&rarr;</span></a></li>
    
  </ul>
</nav>

</div>

<div class="article-container">
  
<section id="comments">
  <div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "httpdangkhoasdcgithubio" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


</div>

<footer class="site-footer">
  <div class="container">
    <p class="powered-by">

      &copy; 2017 Dang-Khoa &middot; 

      Powered by the <a href="https://github.com/gcushen/hugo-academic" target="_blank">Academic
      theme</a> for <a href="http://gohugo.io" target="_blank">Hugo</a>.

      <span class="pull-right" aria-hidden="true">
        <a href="#" id="back_to_top">
          <span class="button_icon">
            <i class="fa fa-chevron-up fa-2x"></i>
          </span>
        </a>
      </span>

    </p>
  </div>
</footer>

    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.js" integrity="sha512-jGsMH83oKe9asCpkOVkBnUrDDTp8wl+adkB2D+//JtlxO4SrLoJdhbOysIFQJloQFD+C4Fl1rMsQZF76JjV0eQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.2/imagesloaded.pkgd.min.js" integrity="sha512-iHzEu7GbSc705hE2skyH6/AlTpOfBmkx7nUqTLGzPYR+C1tRaItbRlJ7hT/D3YQ9SV0fqLKzp4XY9wKulTBGTw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/TweenMax.min.js" integrity="sha512-Z5heTz36xTemt1TbtbfXtTq5lMfYnOkXM2/eWcTTiLU01+Sw4ku1i7vScDc8fWhrP2abz9GQzgKH5NGBLoYlAw==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/1.19.1/plugins/ScrollToPlugin.min.js" integrity="sha512-CDeU7pRtkPX6XJtF/gcFWlEwyaX7mcAp5sO3VIu/ylsdR74wEw4wmBpD5yYTrmMAiAboi9thyBUr1vXRPA7t0Q==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha512-iztkobsvnjKfAtTNdHkGVjAYTrrtlC7mGp/54c40wowO7LhURYl3gVzzcEqGl/qKXQltJ2HwMrdLcNUdo+N/RQ==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.4/isotope.pkgd.min.js" integrity="sha512-VDBOIlDbuC4VWxGJNmuFRQ0Li0SKkDpmGyuhAG5LTDLd/dJ/S0WMVxriR2Y+CyPL5gzjpN4f/6iqWVBJlht0tQ==" crossorigin="anonymous"></script>
    
    <script src="/js/hugo-academic.js"></script>
    

    
    
      
      <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js"></script>

      

      

      <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });
    </script>



    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_CHTML" integrity="sha512-tOav5w1OjvsSJzePRtt2uQPFwBoHt1VZcUq8l8nm5284LEKE9FSJBQryzMBzHxY5P0zRdNqEcpLIRVYFNgu1jw==" crossorigin="anonymous"></script>
    

    

  </body>
</html>

