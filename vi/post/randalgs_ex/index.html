<!DOCTYPE html>
<html lang='vi'>

<head>
  <meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta name='description' content='Các ví dụ về thuật toán ngẫu nhiên Tiếp tục seri về thuật toán ngẫu nhiên, trong bài viết này mình ghi lại 3 ví dụ điển hình trong họ bài toán này. Tất cả các ví dụ đều nằm trong cuốn sách Randomized Algorithms
Randomized Quicksort Thuật toán quicksort có lẽ là một trong những thuật toán khá dễ hiểu khi tìm hiểu về các thuật toán ngẫu nhiên.'>
<meta name='theme-color' content='#44ccff'>

<meta property='og:title' content='Các thuật toán ngẫu nhiên • Dang-Khoa'>
<meta property='og:description' content='Các ví dụ về thuật toán ngẫu nhiên Tiếp tục seri về thuật toán ngẫu nhiên, trong bài viết này mình ghi lại 3 ví dụ điển hình trong họ bài toán này. Tất cả các ví dụ đều nằm trong cuốn sách Randomized Algorithms
Randomized Quicksort Thuật toán quicksort có lẽ là một trong những thuật toán khá dễ hiểu khi tìm hiểu về các thuật toán ngẫu nhiên.'>
<meta property='og:url' content='http://dangkhoasdc.github.io/vi/post/randalgs_ex/'>
<meta property='og:site_name' content='Dang-Khoa&#39;s blog '>
<meta property='og:type' content='article'><meta property='og:image' content='https://www.gravatar.com/avatar/ff98eba7ca4592a175b13bd623f28f0c?s=256'><meta property='article:author' content='https://facebook.com/dangkhoasdc'><meta property='article:section' content='Post'><meta property='article:tag' content='algorithms'><meta property='article:published_time' content='2016-10-23T00:00:00Z'/><meta property='article:modified_time' content='2016-10-23T00:00:00Z'/><meta name='twitter:card' content='summary'><meta name='twitter:creator' content='@dksdc'>

<meta name="generator" content="Hugo 0.54.0" />

  <title>Các thuật toán ngẫu nhiên • Dang-Khoa</title>
  <link rel='canonical' href='http://dangkhoasdc.github.io/vi/post/randalgs_ex/'>
  
  
  <link rel='icon' href='/favicon.ico'>
<link rel='stylesheet' href='/assets/css/main.809149b6.css'><link rel='stylesheet' href='/css/custom.css'><style>
:root{--color-accent:#44ccff;}
</style>

<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-2381283-3', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

  

</head>


<body class='page type-post has-sidebar'>

  <div class='site'>

    <div id='sidebar' class='sidebar'>
  <a class='screen-reader-text' href='#main-menu'>Skip to Main Menu</a>

  <div class='container'><section class='widget widget-about sep-after'>
  <header>
    
    <div class='logo'>
      <a href='/vi/'>
        <img src='/images/logo.svg'>
      </a>
    </div>
    
    <h2 class='title site-title '>
    Dang-Khoa&#39;s blog 
    </h2>
    <div class='desc'>
    just another blog
    </div>
  </header>

</section>
<section class='widget widget-search sep-after'>
  <header>
    <h4 class='title widget-title'>Search</h4>
  </header>

  <form action='/vi/search' id='search-form' class='search-form'>
    <label>
      <span class='screen-reader-text'>Search</span>
      <input id='search-term' class='search-term' type='search' name='q' placeholder='Search&hellip;'>
    </label></form>

</section>
<section class='widget widget-sidebar_menu sep-after'><nav id='sidebar-menu' class='menu sidebar-menu' aria-label='Sidebar Menu'>
    <div class='container'>
      <ul><li class='item'>
  <a href='/vi/'>Trang chủ</a></li><li class='item'>
  <a href='/vi/post/'>Docs</a></li></ul>
    </div>
  </nav>

</section><section class='widget widget-taxonomy_cloud sep-after'>
  <header>
    <h4 class='title widget-title'>Tags</h4>
  </header>

  <div class='container list-container'>
  <ul class='list taxonomy-cloud'><li>
        <a href='/vi/tags/c&#43;&#43;' style='font-size:1em'>C&#43;&#43;</a>
      </li><li>
        <a href='/vi/tags/computer-vision' style='font-size:1em'>Computer Vision</a>
      </li><li>
        <a href='/vi/tags/machine-learning' style='font-size:1em'>Machine Learning</a>
      </li><li>
        <a href='/vi/tags/algorithms' style='font-size:1.6153846153846154em'>algorithms</a>
      </li><li>
        <a href='/vi/tags/android' style='font-size:1em'>android</a>
      </li><li>
        <a href='/vi/tags/books' style='font-size:1.1538461538461537em'>books</a>
      </li><li>
        <a href='/vi/tags/computer-science' style='font-size:1em'>computer science</a>
      </li><li>
        <a href='/vi/tags/computer-vision' style='font-size:1em'>computer vision</a>
      </li><li>
        <a href='/vi/tags/computer-vison' style='font-size:1em'>computer vison</a>
      </li><li>
        <a href='/vi/tags/courses' style='font-size:1em'>courses</a>
      </li><li>
        <a href='/vi/tags/cpp' style='font-size:1.0769230769230769em'>cpp</a>
      </li><li>
        <a href='/vi/tags/cvpr' style='font-size:1em'>cvpr</a>
      </li><li>
        <a href='/vi/tags/deep-learning' style='font-size:1em'>deep learning</a>
      </li><li>
        <a href='/vi/tags/documentary' style='font-size:1em'>documentary</a>
      </li><li>
        <a href='/vi/tags/font' style='font-size:1em'>font</a>
      </li><li>
        <a href='/vi/tags/games' style='font-size:1.0769230769230769em'>games</a>
      </li><li>
        <a href='/vi/tags/gaming' style='font-size:1.0769230769230769em'>gaming</a>
      </li><li>
        <a href='/vi/tags/history' style='font-size:1em'>history</a>
      </li><li>
        <a href='/vi/tags/laptop' style='font-size:1em'>laptop</a>
      </li><li>
        <a href='/vi/tags/machine-learning' style='font-size:1em'>machine learning</a>
      </li><li>
        <a href='/vi/tags/memories' style='font-size:1.1538461538461537em'>memories</a>
      </li><li>
        <a href='/vi/tags/misc' style='font-size:1.6153846153846154em'>misc</a>
      </li><li>
        <a href='/vi/tags/movies' style='font-size:1.3076923076923077em'>movies</a>
      </li><li>
        <a href='/vi/tags/notes' style='font-size:1.0769230769230769em'>notes</a>
      </li><li>
        <a href='/vi/tags/opencv' style='font-size:1.0769230769230769em'>opencv</a>
      </li><li>
        <a href='/vi/tags/programming' style='font-size:2em'>programming</a>
      </li><li>
        <a href='/vi/tags/python' style='font-size:1.0769230769230769em'>python</a>
      </li><li>
        <a href='/vi/tags/research' style='font-size:1.1538461538461537em'>research</a>
      </li><li>
        <a href='/vi/tags/review' style='font-size:1.7692307692307692em'>review</a>
      </li><li>
        <a href='/vi/tags/singapore' style='font-size:1em'>singapore</a>
      </li><li>
        <a href='/vi/tags/software-engineer' style='font-size:1em'>software engineer</a>
      </li><li>
        <a href='/vi/tags/taocp' style='font-size:1.0769230769230769em'>taocp</a>
      </li><li>
        <a href='/vi/tags/travel' style='font-size:1.1538461538461537em'>travel</a>
      </li><li>
        <a href='/vi/tags/tutorial' style='font-size:1em'>tutorial</a>
      </li><li>
        <a href='/vi/tags/vietnam' style='font-size:1em'>vietnam</a>
      </li><li>
        <a href='/vi/tags/visual-studio' style='font-size:1em'>visual studio</a>
      </li></ul>
</div>


</section>
</div>

  <div class='sidebar-overlay'></div>
</div>

    <div class='main'>

      <nav id='main-menu' class='menu main-menu' aria-label='Main Menu'>
  <div class='container'>
    <a class='screen-reader-text' href='#content'>Skip to Content</a>

<button id='sidebar-toggler' class='sidebar-toggler' aria-controls='sidebar'>
  <span class='screen-reader-text'>Toggle Sidebar</span>
  <span class='open'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="3" y1="12" x2="21" y2="12" />
  <line x1="3" y1="6" x2="21" y2="6" />
  <line x1="3" y1="18" x2="21" y2="18" />
  
</svg>
</span>
  <span class='close'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="18" y1="6" x2="6" y2="18" />
  <line x1="6" y1="6" x2="18" y2="18" />
  
</svg>
</span>
</button>
    <ul><li class='item'>
        <a href='/vi/' class="">
          <span>Trang chủ</span>
        </a>
      </li><li class='item'>
        <a href='/vi/post/' class="">
          <span>Docs</span>
        </a>
      </li><li class='item'>
        <a href='/vi/dangkhoasdc/' class="">
          <span>dangkhoasdc</span>
        </a>
      </li><li class='item'>
        <a href='/vi/' class="vi">
          <span>Tiếng Việt</span>
        </a>
      </li><li class='item'>
        <a href='/' class="en">
          <span>English</span>
        </a>
      </li></ul>
  </div>
</nav>

      <header id='header' class='header site-header'>
        <div class='container sep-after'>
          <div class='header-info'><p class='site-title title'>Dang-Khoa&#39;s blog </p><p class='desc site-desc'>just another blog</p>
          </div>
        </div>
      </header>

      <main id='content'>


<article lang='vi' class='entry'>
  <header class='header entry-header'>
  <div class='container sep-after'>
    <div class='header-info'>
      <h1 class='title'>Các thuật toán ngẫu nhiên</h1>
      

    </div>
    
<div class='entry-meta'>
  <span class='posted-on'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
  <line x1="16" y1="2" x2="16" y2="6"/>
  <line x1="8" y1="2" x2="8" y2="6"/>
  <line x1="3" y1="10" x2="21" y2="10"/>
  
</svg>
<span class='screen-reader-text'>Posted on </span>
  <time class='entry-date' datetime='2016-10-23T00:00:00Z'>2016, Oct 23</time>
</span>

  <span class='byline'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M21,21V20c0-2.76-4-5-9-5s-9,2.24-9,5v1"/>
  <path d="M16,6.37A4,4,0,1,1,12.63,3,4,4,0,0,1,16,6.37Z"/>
  
</svg>
<span class='screen-reader-text'> by </span><a href='/vi/authors/khoa'>Dang-Khoa</a></span>
  
<span class='reading-time'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <circle cx="12" cy="12" r="10"/>
  <polyline points="12 6 12 12 15 15"/>
  
</svg>
10 mins read
</span>


  
  
</div>


  </div>
</header>

  
  

  <div class='container entry-content'>
  

<h1 id="các-ví-dụ-về-thuật-toán-ngẫu-nhiên">Các ví dụ về thuật toán ngẫu nhiên</h1>

<p>Tiếp tục seri về thuật toán ngẫu nhiên, trong bài viết này mình ghi lại 3 ví dụ điển hình trong họ bài toán này. Tất cả các ví dụ đều nằm trong cuốn sách <a href="https://www.amazon.com/Randomized-Algorithms-Rajeev-Motwani/dp/0521474655" target="_blank">Randomized Algorithms</a></p>

<h1 id="randomized-quicksort">Randomized Quicksort</h1>

<p>Thuật toán quicksort có lẽ là một trong những thuật toán khá dễ hiểu khi tìm hiểu về các thuật toán ngẫu nhiên. Thử tưởng tượng ta cho quicksort thông thường chạy 10 lần với dữ liệu đã sắp xếp với randomized-quicksort cũng với cấu hình như vậy, ta sẽ thấy sự khác biệt lớn.</p>

<h2 id="thuật-toán">Thuật toán</h2>

<h2 id="chứng-minh">Chứng minh</h2>

<p>Cho dữ liệu đầu vào gồm $n$ phần tử khác nhau. Gọi $S_i, 1 \leq i \leq n$ là phần tử <em>rank i</em> (phần tử nhỏ thứ <em>i</em>) trong mảng, đồng thời ta có $X_{ij}$ biến ngẫu nhiên bằng 1 nếu xuất hiện phép so sánh của 2 phần tử $S_i$ và $S_j$ trong quá trình thực thi, bằng không nếu không xuất hiện phép so sánh nào.</p>

<p>Như vậy, độ phức tạp của <code>randomized-quicksort</code> được tính thông qua quá trình sắp xếp mảng theo pivot mà chi phí chính nằm ở phép so sánh các phần tử, tổng chi phí chính là</p>

<p>$$ \sum_{i=1}^n \sum_{j&gt;i} X_{ij} $$</p>

<p>Tuy nhiên, điều ta quan tâm hơn ở đây là <em>kì vọng</em> chi phí trong các lần thực thi:</p>

<p>$$E \left [ \sum_{i=1}^n \sum_{j&gt;i} X_{ij} \right ] = \sum_{i=1}^n \sum_{j&gt;i} E[X_{ij}]$$</p>

<p>Công thức trên được xây dựng dựa vào một tính chất của kì vọng: <a href="https://brilliant.org/wiki/linearity-of-expectation/" target="_blank">tính tuyến tính của kì vọng</a>. Như vậy kì vọng của tổng các chi phí so sánh chính bằng tổng của từng kì vọng của biến ngẫu nhiên $ X_{ij}$. Gọi $p_{ij}$ là xác suất để $X_{ij}=1$. Ta có:</p>

<p>$$ E[X_{ij}] = p_{ij} * 1 + (1-p) * 0 = p_{ij} $$
$$ E \left [ \sum_{i=1}^n \sum_{j&gt;i} X_{ij} \right ] = \sum_{i=1}^n \sum_{j&gt;i} p_{ij} $$</p>

<p>Bài toán được qui về việc tính xác suất khi nào phép so sánh giữa hai phần tử $S_i$ và $S_j$ xuất hiện.</p>

<p>Nếu ta xem quá trình thực thi của <code>randomized-quicksort</code> là quá trình xây dựng cây nhị phân: với mỗi node chính là 1 pivot tại thời điểm gọi hàm <code>partition</code>, kết quả hàm <code>partition</code> ta có được 2 cây con bên trái và phải của node pivot dùng để so sánh. Nếu $S_i$ và $S_j$ nằm ở hai nhánh con trái-phải thì phép so sánh giữa hai phần tử này chắc chắn không xảy ra. Như vậy $S_i$ và $S_j$ có quan hệ cha con - một trong hai phần tử phải thuộc node cấp lớn hơn của node kia. Một giả thuyết khác cần xem xét đó là xác suất các số được chọn làm pivot phải bằng nhau (uniform distribution) - có được giả thuyết này ta mới tính được độ phức tạp trong thời gian trung bình được.</p>

<p>Như vậy, để $X_{ij}=1$ khi và chỉ khi một trong hay vị trí $S_i$ hoặc $S_j$ được chọn, và đó là $p_{ij} = \frac{2}{j - i + 1} $ (Xác suất này được tính khi loại đi xác suất chọn phải những pivot nằm bên trái của $S_i$ hoặc nằm bên phải của $S_j$)</p>

<p>Như vậy ta có:</p>

<p>$$E \left [ \sum_{i=1}^n \sum_{j&gt;i} X_{ij} \right ] = \sum_{i=1}^n \sum_{j&gt;i} \frac{2}{j - i + 1}$$</p>

<p>Đặt $k = j - i + 1$, ta được:</p>

<p>$$\sum_{i=1}^n \sum_{j&gt;i} p_{ij} \leq \sum_{i=1}^n \sum_{k=1}^{n-i+1} \frac{1}{k}$$</p>

<p>$$\leq 2 \sum_{i=1}^n \sum_{k=1}^{n} \frac{1}{k}$$</p>

<p>$$= 2n \sum_{k=1}^{n} \frac{1}{k}$$</p>

<p>$\sum_{k=1}^{n} \frac{1}{k}$ chính là <a href="https://en.wikipedia.org/wiki/Harmonic_series_(mathematics)#Rate_of_divergence" target="_blank">chuỗi harmony</a> và tổng này sẽ hội tụ về xấp xỉ của $ln(n)$. Và như vậy</p>

<p>$$E \left [ \sum_{i=1}^n \sum_{j&gt;i} X_{ij} \right ] \leq 2n\log{n}$$</p>

<h1 id="random-mincut">Random Mincut</h1>

<h2 id="ví-dụ">Ví dụ</h2>

<p>Giả sử ta có dữ liệu facebook của đám bạn cấp 3 và đang tò mò xem trong chục năm qua, những đứa bạn đó có lập thành nhóm chơi thân nào không. Dữ liệu đầu vào là danh sách các bạn trong lớp cấp 3 và mỗi quan hệ từng người với nhau (quan hệ bạn cấp 3, bạn đại học, đồng nghiệp, quan hệ nam nữ, vợ chồng).</p>

<p>Giả sử ta tạo một đồ thị với đỉnh là một người trong lớp, <code>a</code> có thể nối với <code>b</code> thông qua các cạnh nối:</p>

<ul>
<li>Bạn cấp 3 (cái này chắc chắn)</li>
<li>Bạn đại học</li>
<li>Đồng nghiệp</li>
</ul>

<p>Việc tìm ra nhóm bạn <em>thân</em> - tức gắng bó với nhau sau thời gian cấp 3 chính là việc tìm cách tách đồ thị lớn này thành những đồ thị con.</p>

<p>Những bài toán <em>chia cắt</em> đồ thị gọi là <em>graph cut</em>, nếu trong bài toán yêu cầu tìm ra đoạn cắt nào có chi phí thấp nhất: cắt ít số cạnh nhất - thì đó chính là bài toán tìm <em>mincut</em>.</p>

<p>Trong ví dụ này ta xét đồ thị là một <a href="http://mathworld.wolfram.com/Multigraph.html" target="_blank">multigraph</a> - tức đồ thị có thể có nhiều cạnh cùng nối chung hai điểm. Một số định nghĩa cho phép <em>multigraph</em> là đồ thị có các cạnh lặp (self-loop). Để thuận tiện cho việc chứng minh và minh hoạ, các đồ thị được đề cập trong bài là các đồ thị vô hướng.</p>

<h2 id="karger-mincut-https-en-wikipedia-org-wiki-karger-27s-algorithm"><a href="https://en.wikipedia.org/wiki/Karger%27s_algorithm" target="_blank">Karger Mincut</a></h2>

<p><img src="https://upload.wikimedia.org/wikipedia/commons/e/e7/Single_run_of_Karger%E2%80%99s_Mincut_algorithm.svg" alt="Minh hoạ thuật toán Karger" /></p>

<p>Một quá trình quan trọng trong thuật toán Karger là <em>Edge Contraction</em> - gộp cạnh. Cho một cạnh $ e = {u, v}$, sau phép gộp cạnh ta sẽ có được một <em>đỉnh</em> mới là $uv$ trong đó tất cả các cạnh nối từ $u$ đến $v$ hay ngược lại đều bị loại bỏ, đồng thời các cạnh lặp (self-loop) cũng bị xoá bỏ.</p>

<p>Với các cạnh khác $ e’ = {u, w}$ hay $e’={v, w}$ đều trở thành $e’={uv,w}$.</p>

<p>Một cách đơn giản: phép gộp cạnh sẽ nhập 2 đỉnh lại với nhau - xoá toàn bộ các cạnh nối 2 cạnh cũ và giữ lại những cạnh nối 2 đỉnh đó với các đỉnh khác trong đồ thị.</p>

<p>Thuật toán được mô tả như sau:</p>

<pre><code>1. Chọn ngẫu nhiên (theo phân phối đều) một cạnh trong đồ thị.
2. Thực hiện phép gộp cạnh vừa chọn.
3. Lặp lại bước (1) cho đến khi số đỉnh trong đồ thị còn lại 2.
4. Output: min-cut là các cạnh còn lại trong đồ thị
</code></pre>

<h2 id="tính-đúng-đắng-của-giải-thuật">Tính đúng đắng của giải thuật</h2>

<p>Để có thể tính được độ phức tạp trong thời gian trung bình, ta cần quay lại một chút về các tính chất của đồ thị. Cho đa đồ thị (multigraph) $G=(V, E)$ gồm các đỉnh $V$ và các cạnh $E$. Gọi $d(v)$ là bậc của đỉnh $v$ là tổng số các cạnh liên thuộc với $v$. Ta có tính chất sau:</p>

<p>$$\sum_{v \in V} d(v) = 2 | E |$$</p>

<p>Gọi $C$ là lát cắt có kích thước nhỏ nhất $k$ - tức số lượng các cạnh trong lát cắt đó là $k$. Do đó, bậc tối thiểu của mỗi cạnh trong đồ thị này là $k$. Bởi nếu tồn tại một đỉnh có bậc nhỏ hơn $k$ thì lắt cắt $k$ không phải là lát cắt nhỏ nhất.</p>

<p>Như vậy ta có:</p>

<p>$$nk \leq \sum_{v \in V} d(v) = 2 | E |$$
$$|E| \geq \frac{nk}{2}$$</p>

<p>Ta thấy xác suất để thuật toán gộp cạnh chọn đúng ngay 1 cạnh trong C chính là</p>

<p>$$\frac{k}{|E|}$$</p>

<p>kết hợp với bất đẳng thức phía trên, ta được:</p>

<p>$$\frac{k}{|E|} \leq \frac{2k}{nk} = \frac{2}{n}$$</p>

<p>Như vậy, xác suất để thuật toán gộp cạnh không chọn phải các cạnh của $C$ là $p_n $.</p>

<p>Ta có $p_n \leq (1-\frac{2}{n})p_{n-1} $ .</p>

<p>Đồng thời ta cũng có $ p_2 = 1 $ lí do là bởi Karger chỉ chọn cạnh để gộp khi $ \vert V \vert &gt; 2 $</p>

<p>Nên khi $ n=2 $ thì biến cố chọn phải cạnh để gộp nằm trong $ C $ chắc chắn không xảy ra.</p>

<p>Xác suất $p_n$ có cận như sau:</p>

<p>$$p_n \geq \prod_{i=0}^{n-3} \left (1 - \frac{2}{n-i} \right ) = \frac{2}{n(n-1)}$$</p>

<p>Để dễ tưởng tượng hơn, ta có thể phân tích một chút về trường hợp Karger không tìm ra được mincut, rõ ràng xác suất đó chính là $ 1 - \frac{2}{n(n-1)}$, để tăng độ chính xác, ta có thể cho Karger chạy $k$ lần. Lúc này, xác suất Karger không tìm ra được mincut là: $ \left (1 - \frac{2}{n(n-1)} \right )^k$. Có một bất đẳng thức thú vị ở đây:</p>

<p>$$\frac{1}{4} \leq \left (1 - \frac{1}{x} \right )^ x \leq \frac{1}{e}$$</p>

<p>Giả sử $k = \frac{n(n-1)}{2}\ln n$ ta có được kết quả khá đẹp như sau:</p>

<p>$$\left (1 - \frac{2}{n(n-1)} \right )^{\frac{n(n-1)}{2}\ln n} \leq \left (\frac{1}{e} \right )^{\frac{n(n-1)}{2}\ln n} = \left (\frac{1}{e} \right ) ^{\ln n} = \frac{1}{n}$$</p>

<h1 id="binary-planar-partitions">Binary Planar Partitions</h1>

<h2 id="giới-thiệu">Giới thiệu</h2>

<p><img src="http://i.imgur.com/cGwRyxq.png" alt="Một ví dụ về cây BSP" /></p>

<p>Binary Planar Partitions (trong trường hợp tổng quát là <em>Binary Space Partitions</em>) là một phương pháp phổ biến được sử dụng nhằm chia cắt không gian thành các tập lồi (convex set) chứa các siêu phẳng - hyperplane. Sự chia cắt này tạo nên một cấu trúc dữ liệu được gọi là cây BSP.</p>

<p>BSP có nhiều ứng dụng, đặc biệt là trong các bài toán về đồ hoạ. Điển hình như trong bài toán dựng hình (xác định đối tượng nào được dựng trong khung hình từ góc một góc nhìn nào đó), trong hệ thống CAD, phát hiện va chạm trong robotics, cũng như trong các bài toán chứa các cấu trúc không gian phức tạp.</p>

<p>Trong trường hợp tổng quát, cây BSP, từ mỗi node của mình sẽ chia không gian thành hai nửa siêu phẳng, từ mỗi nửa siêu phẳng đó sẽ tiếp tục được chia cắt thành các nửa siêu phẳng nhỏ hơn sao cho những node lá cuối cùng sẽ chứa 1 đối tượng mà thuộc không gian. Có thể thấy cây BSP là trường hợp tổng quát của cây <a href="https://en.wikipedia.org/wiki/K-d_tree" target="_blank">k-d</a>, và <a href="https://en.wikipedia.org/wiki/Quadtree" target="_blank">Quadtree</a>.</p>

<h2 id="ví-dụ-1">Ví dụ</h2>

<p>Để đơn giản bài toán ta xét trường hợp mặt phẳng với dữ liệu đầu vào là tập các đoạn thẳng sao cho từng cặp trong tập không giao nhau $S={s_1, s_2, \dots, s_n}$, output của bài toán là một cây BSP mà mỗi vùng trong mỗi node lá chỉ chứa 1 một đoạn thẳng.</p>

<ol>
<li>Chọn ngẫu nhiên (theo phân phối đều) một hoán vị $\pi$ trong tập hoá vị của ${1, 2, \dots, n }$ (gồm $n!$ phần tử).</li>

<li><p>Tồn tại một vùng chứa nhiều hơn 1 đoạn thẳng:</p>

<p>2.a Cắt vùng này bởi <em>đường thẳng</em> $l(s_i)$ trong đó $i$ là phần tử đầu tiên trong hoán vị (ở đây đường thẳng $l$ sẽ chứa $s_i$) $\pi$ sao cho $s_i$ cắt vùng đang xét.</p></li>
</ol>

<h2 id="phân-tích">Phân tích</h2>

<p>Gọi biến $X_{ij}$ là biến ngẫu nhiên và $X_{ij}=1$ khi đường thẳng chứa $s_i$ cắt $s_j$ trong một vòng gọi đệ quy nào đó, $X_{ij}=0$ trong trường hợp ngược lại.</p>

<p>Ở đây ta muốn xét xem kì vọng số lần thuật toán này cắt phải một đoạn thẳng trong tập đầu vào $S$.</p>

<p>$$\mathbf{E} (X) = \mathbf{E} \left [ \sum_{i=1}^{n} \sum_{i=1}^{n} X _ {ij} \right ]$$
$$= \sum_{i=1}^{n} \sum_{i=1}^{n} \mathbf{E} [X _ {ij} ]$$
$$= \sum_{i=1}^{n} \sum_{i=1}^{n} Pr [X _ {ij} = 1 ]$$</p>

<p>Bài toán được quy về việc tính xác suất $Pr[X_{ij}=1]$. Gọi $t$ là giao điểm của $s_i$ và $s_j$, $index(i,j)=t$ nếu $s_i$ cắt $t-1$ đoạn thẳng trước khi giao với $s_j$, như ví dụ bên dưới $s_{ij}=4$. Trường hợp hai đoạn thẳng không cắt nhau thì $S_{ij}=\infty$.</p>

<p><img src="http://i.imgur.com/kyaZ5CL.png" alt="Ví dụ về giá trị index(i, j)" /></p>

<p>Bởi đường thẳng chứa $s_i$ bất kì có thể tiến vô cùng về hai phía nên tồn tại hai đoạn sao cho $index(s_i, s_j) = index(s_i, s_k)$. Nếu $index(s_i, s_j)=t$ ta gọi $s_{i1}, s_{i2}, \dots, s_{it}$ là những đoạn thẳng mà $s_i$ sẽ cắt trước khi giao với $s_j$, xác suất đề sự kiện này xảy ra là $\frac{1}{t+1}$</p>

<p>Cho một đoạn $s_k$ cố định và $m \in {0, 1, 2, dots, n-2 }$ tồn tại tối đa hai đoạn thẳng $s_l$ sao cho $index(s_l, s_k)=m$</p>

<p>Cận trên được tính như sau:</p>

<p>$$\mathbf{E}[X] = \sum_{i=1}^{n} \sum_{j=1}^{n} Pr [X _ {ij} = 1 ]$$
$$\leq \sum_{i=1}^{n} \sum_{j=1}^{n} \frac{1}{index(i, j) + 1}$$
$$\sum_{i=1}^{n} \sum_{k=2}^{n} \frac{2}{k}$$
$$= 2n \ln n$$</p>

<h1 id="tài-liệu-tham-khảo">Tài liệu tham khảo.</h1>

<ol>
<li><a href="http://www.csee.wvu.edu/~ksmani/courses/fa01/random/lecnotes/lecture2.pdf" target="_blank">Introduction to Randomized Algorithms</a></li>
<li><a href="http://cs.au.dk/~gudmund/Documents/randompearlnotes.pdf" target="_blank">Randomised Algorithms</a></li>
</ol>

</div>

  
<footer class='entry-footer'>
  <div class='container sep-before'>
  <div class='tags'>
  <span class='taxonomy-icon'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M20.59,13.41l-7.17,7.17a2,2,0,0,1-2.83,0L2,12V2H12l8.59,8.59A2,2,0,0,1,20.59,13.41Z"/>
  <line x1="7" y1="7" x2="7" y2="7"/>
  
</svg>
</span>
  <span class='screen-reader-text'>Tags: </span><a class='tag' href='/vi/tags/algorithms'>algorithms</a></div>

  </div>
</footer>


</article>

<nav class='entry-nav'>
  <div class='container'><div class='prev-entry sep-before'>
      <a href='/vi/post/startwars-vii-review/'>
        <span aria-hidden='true'><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="20" y1="12" x2="4" y2="12"/>
  <polyline points="10 18 4 12 10 6"/>
  
</svg>
 Previous</span>
        <span class='screen-reader-text'>Previous post: </span>Cảm nhận Star Wars VII: The Force Awakens</a>
    </div><div class='next-entry sep-before'>
      <a href='/vi/post/rand/'>
        <span class='screen-reader-text'>Next post: </span>rand() is harmful<span aria-hidden='true'>Next <svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <line x1="4" y1="12" x2="20" y2="12"/>
  <polyline points="14 6 20 12 14 18"/>
  
</svg>
</span>
      </a>
    </div></div>
</nav>


<section id='comments' class='comments'>
  <div class='container sep-before'>
    <div class='comments-area'><div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "httpdangkhoasdcgithubio" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>
  </div>
</section>

      </main>

      <footer id='footer' class='footer'>
        <div class='container sep-before'><section class='widget widget-social_menu sep-after'><nav aria-label='Social Menu'>
    <ul><li>
        <a href='https://github.com/dangkhoasdc' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Open Github account in new tab</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"/>
  
</svg>
</a>
      </li><li>
        <a href='mailto:letan.dangkhoa@gmail.com' target='_blank' rel='noopener'>
          <span class='screen-reader-text'>Contact via Email</span><svg class='icon' viewbox='0 0 24 24' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' aria-hidden='true'>
  
  <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
  <polyline points="22,6 12,13 2,6"/>
  
</svg>
</a>
      </li></ul>
  </nav>
</section><div class='copyright'>
  <p> &copy; 2017-2019 Dang-Khoa </p>
</div>

        </div>
      </footer>

    </div>
  </div><script>window.__public_path__='http:\/\/dangkhoasdc.github.io\/assets\/js\/'</script>

<script src='http://dangkhoasdc.github.io/assets/js/main.68cb493a.js'></script>
<script src="//instant.page/1.1.0" type="module" integrity="sha384-EwBObn5QAxP8f09iemwAJljc+sU+eUXeL9vSBw1eNmVarwhKk2F9vBEpaN9rsrtp"></script><script src='/js/custom.js'></script><script type='text/x-mathjax-config'>
  MathJax.Hub.Config({"tex2jax":{"inlineMath":[["$","$"],["\\(","\\)"]],"processEscapes":true}})
</script>

<script type='text/javascript' async src='//unpkg.com/mathjax/MathJax.js?config=TeX-MML-AM_CHTML'></script>





</body>

</html>






















